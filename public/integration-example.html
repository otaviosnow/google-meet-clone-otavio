<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exemplo de Integra√ß√£o - CallX</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .code-block {
            background: #f4f4f4;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            overflow-x: auto;
        }
        .highlight {
            background: #fff3cd;
            padding: 10px;
            border-radius: 4px;
            border-left: 4px solid #ffc107;
        }
        .button {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .button:hover {
            background: #0056b3;
        }
        .success {
            background: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üîó Exemplo de Integra√ß√£o CallX</h1>
    
    <div class="highlight">
        <strong>Como integrar o CallX em suas p√°ginas da Hostgator/Elementor:</strong>
        <p>Este exemplo mostra como adicionar um bot√£o que cria reuni√µes automaticamente.</p>
    </div>

    <h2>5. C√≥digo JavaScript</h2>
    <p>Adicione este c√≥digo no seu site (via Elementor HTML widget ou no c√≥digo da p√°gina):</p>

    <div class="code-block">
<pre><code>&lt;script&gt;
// Configura√ß√£o da integra√ß√£o CallX
const CALLX_CONFIG = {
    apiUrl: 'https://google-meet-saas-v2.onrender.com/api/integration',
    token: 'SEU_TOKEN_AQUI', // Substitua pelo seu token
    defaultVideoId: null // ID do v√≠deo padr√£o (opcional)
};

// Fun√ß√£o para criar reuni√£o
async function createCallXMeeting(videoId = null, title = null, redirectUrl = null, buttonElement = null) {
    // Bloquear bot√£o imediatamente
    if (buttonElement) {
        buttonElement.disabled = true;
        buttonElement.textContent = '‚è≥ Criando reuni√£o...';
        buttonElement.style.opacity = '0.6';
        buttonElement.style.cursor = 'not-allowed';
    }

    try {
        const response = await fetch(`${CALLX_CONFIG.apiUrl}/create-meeting`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                token: CALLX_CONFIG.token,
                videoId: videoId || CALLX_CONFIG.defaultVideoId,
                title: title || 'Reuni√£o via Site',
                redirectUrl: redirectUrl || window.location.href,
                customerInfo: {
                    source: window.location.href,
                    userAgent: navigator.userAgent,
                    timestamp: new Date().toISOString()
                }
            })
        });

        const result = await response.json();

        if (response.ok) {
            // Sucesso - bloquear bot√£o permanentemente
            if (buttonElement) {
                buttonElement.disabled = true;
                buttonElement.textContent = '‚úÖ Reuni√£o criada!';
                buttonElement.style.background = '#28a745';
                buttonElement.style.cursor = 'not-allowed';
                buttonElement.style.opacity = '0.8';
                
                // Salvar estado no localStorage
                localStorage.setItem('callx_meeting_created', 'true');
                localStorage.setItem('callx_meeting_id', result.meetingId);
                
                console.log('‚úÖ Reuni√£o criada, localStorage salvo:', {
                    created: localStorage.getItem('callx_meeting_created'),
                    meetingId: localStorage.getItem('callx_meeting_id')
                });
            }

            // Redirecionar para a reuni√£o
            if (result.redirectUrl) {
                window.location.href = result.redirectUrl;
            } else {
                window.open(result.meetLink, '_blank');
            }
        } else {
            // Erro - desbloquear bot√£o
            if (buttonElement) {
                buttonElement.disabled = false;
                buttonElement.textContent = 'üöÄ Iniciar Reuni√£o';
                buttonElement.style.opacity = '1';
                buttonElement.style.cursor = 'pointer';
            }
            
            console.error('Erro ao criar reuni√£o:', result.error);
            alert('Erro ao criar reuni√£o: ' + result.error);
        }
    } catch (error) {
        // Erro - desbloquear bot√£o
        if (buttonElement) {
            buttonElement.disabled = false;
            buttonElement.textContent = 'üöÄ Iniciar Reuni√£o';
            buttonElement.style.opacity = '1';
            buttonElement.style.cursor = 'pointer';
        }
        
        console.error('Erro na requisi√ß√£o:', error);
        alert('Erro ao conectar com o CallX');
    }
}

// Fun√ß√£o para listar v√≠deos dispon√≠veis
async function loadCallXVideos() {
    try {
        const response = await fetch(`${CALLX_CONFIG.apiUrl}/tokens/${CALLX_CONFIG.token}/videos`);
        const result = await response.json();
        
        if (response.ok) {
            return result.videos;
        } else {
            console.error('Erro ao carregar v√≠deos:', result.error);
            return [];
        }
    } catch (error) {
        console.error('Erro ao carregar v√≠deos:', error);
        return [];
    }
}

// Fun√ß√£o para criar bot√£o din√¢mico
async function createCallXButton(containerId, buttonText = 'Iniciar Reuni√£o') {
    const container = document.getElementById(containerId);
    if (!container) return;

    // Verificar se j√° foi criada uma reuni√£o
    const meetingCreated = localStorage.getItem('callx_meeting_created');
    const meetingId = localStorage.getItem('callx_meeting_id');
    
    if (meetingCreated === 'true' && meetingId) {
        // Reuni√£o j√° foi criada - mostrar bot√£o bloqueado
        const button = document.createElement('button');
        button.textContent = '‚úÖ Reuni√£o j√° criada!';
        button.className = 'callx-button';
        button.disabled = true;
        button.style.background = '#28a745';
        button.style.cursor = 'not-allowed';
        button.style.opacity = '0.8';
        
        // Adicionar link para a reuni√£o
        const link = document.createElement('a');
        link.href = `https://google-meet-saas-v2.onrender.com/meet/${meetingId}`;
        link.target = '_blank';
        link.textContent = 'Abrir Reuni√£o';
        link.style.cssText = `
            display: block;
            margin-top: 10px;
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
        `;
        
        container.appendChild(button);
        container.appendChild(link);
        return;
    }

    // Carregar v√≠deos dispon√≠veis
    const videos = await loadCallXVideos();
    
    if (videos.length === 0) {
        container.innerHTML = '&lt;p&gt;Nenhum v√≠deo configurado&lt;/p&gt;';
        return;
    }

    // Se h√° apenas um v√≠deo, criar bot√£o simples
    if (videos.length === 1) {
        const button = document.createElement('button');
        button.textContent = buttonText;
        button.className = 'callx-button';
        button.onclick = () => createCallXMeeting(videos[0].id, null, null, button);
        container.appendChild(button);
        return;
    }

    // Se h√° m√∫ltiplos v√≠deos, criar dropdown
    const select = document.createElement('select');
    select.className = 'callx-video-select';
    
    videos.forEach(video => {
        const option = document.createElement('option');
        option.value = video.id;
        option.textContent = video.name;
        select.appendChild(option);
    });

    const button = document.createElement('button');
    button.textContent = buttonText;
    button.className = 'callx-button';
    button.onclick = () => createCallXMeeting(select.value, null, null, button);

    container.appendChild(select);
    container.appendChild(button);
}
&lt;/script&gt;</code></pre>
    </div>

    <h2>3. Exemplos de Uso</h2>

    <h3>C√≥digo Simplificado (Recomendado)</h3>
    <div class="code-block">
<pre><code>&lt;div style="text-align: center; padding: 40px;"&gt;
    &lt;h2&gt;Clique no bot√£o abaixo para fazer a chamada comigo‚Äã&lt;/h2&gt;
    &lt;p&gt;Estou te esperando&lt;/p&gt;
    &lt;div id="callx-integration"&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;script&gt;
// Configura√ß√£o
const CALLX_CONFIG = {
    apiUrl: 'https://google-meet-saas-v2.onrender.com/api/integration',
    token: 'SEU_TOKEN_AQUI'
};

// Fun√ß√£o com bloqueio de bot√£o
async function createCallXMeeting(buttonElement) {
    // Bloquear bot√£o imediatamente
    buttonElement.disabled = true;
    buttonElement.textContent = '‚è≥ Criando reuni√£o...';
    buttonElement.style.opacity = '0.6';
    buttonElement.style.cursor = 'not-allowed';

    try {
        const response = await fetch(`${CALLX_CONFIG.apiUrl}/create-meeting`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                token: CALLX_CONFIG.token,
                title: 'Reuni√£o via Site',
                redirectUrl: window.location.href
            })
        });

        const result = await response.json();
        
        if (response.ok) {
            // Sucesso - bloquear permanentemente
            buttonElement.textContent = '‚úÖ Reuni√£o criada!';
            buttonElement.style.background = '#28a745';
            buttonElement.style.opacity = '0.8';
            
            // Salvar no localStorage
            localStorage.setItem('callx_meeting_created', 'true');
            localStorage.setItem('callx_meeting_id', result.meetingId);
            
            // Abrir reuni√£o
            window.open(result.meetLink, '_blank');
        } else {
            // Erro - desbloquear
            buttonElement.disabled = false;
            buttonElement.textContent = 'üöÄ Iniciar Reuni√£o';
            buttonElement.style.opacity = '1';
            buttonElement.style.cursor = 'pointer';
            alert('Erro: ' + result.error);
        }
    } catch (error) {
        // Erro - desbloquear
        buttonElement.disabled = false;
        buttonElement.textContent = 'üöÄ Iniciar Reuni√£o';
        buttonElement.style.opacity = '1';
        buttonElement.style.cursor = 'pointer';
        alert('Erro ao conectar com o CallX');
    }
}

// Criar bot√£o
document.addEventListener('DOMContentLoaded', () => {
    const container = document.getElementById('callx-integration');
    if (container) {
        // Verificar se j√° foi criada uma reuni√£o
        const meetingCreated = localStorage.getItem('callx_meeting_created');
        const meetingId = localStorage.getItem('callx_meeting_id');
        
        if (meetingCreated === 'true' && meetingId) {
            // Reuni√£o j√° criada - mostrar bot√£o bloqueado
            const button = document.createElement('button');
            button.textContent = '‚úÖ Reuni√£o j√° criada!';
            button.disabled = true;
            button.style.cssText = `
                background: #28a745;
                color: white;
                padding: 15px 30px;
                border: none;
                border-radius: 8px;
                font-size: 18px;
                cursor: not-allowed;
                opacity: 0.8;
            `;
            
            const link = document.createElement('a');
            link.href = `https://google-meet-saas-v2.onrender.com/meet/${meetingId}`;
            link.target = '_blank';
            link.textContent = 'Abrir Reuni√£o';
            link.style.cssText = `
                display: block;
                margin-top: 10px;
                color: #007bff;
                text-decoration: none;
                font-weight: bold;
            `;
            
            container.appendChild(button);
            container.appendChild(link);
        } else {
            // Criar bot√£o normal
            const button = document.createElement('button');
            button.textContent = 'üöÄ Iniciar Reuni√£o';
            button.style.cssText = `
                background: #007bff;
                color: white;
                padding: 15px 30px;
                border: none;
                border-radius: 8px;
                font-size: 18px;
                cursor: pointer;
                transition: background 0.3s;
            `;
            button.onmouseover = () => button.style.background = '#0056b3';
            button.onmouseout = () => button.style.background = '#007bff';
            button.onclick = () => createCallXMeeting(button);
            
            container.appendChild(button);
        }
    }
});
&lt;/script&gt;</code></pre>
    </div>

    <h3>Bot√£o Simples</h3>
    <div class="code-block">
<pre><code>&lt;!-- HTML --&gt;
&lt;div id="callx-button-container"&gt;&lt;/div&gt;

&lt;script&gt;
// Criar bot√£o quando a p√°gina carregar
document.addEventListener('DOMContentLoaded', () => {
    createCallXButton('callx-button-container', 'Iniciar Reuni√£o');
});
&lt;/script&gt;</code></pre>
    </div>

    <h3>Bot√£o com V√≠deo Espec√≠fico</h3>
    <div class="code-block">
<pre><code>&lt;button onclick="createCallXMeeting('VIDEO_ID_AQUI', 'Reuni√£o Personalizada', null, this)"&gt;
    Iniciar Reuni√£o Espec√≠fica
&lt;/button&gt;</code></pre>
    </div>

    <h3>Integra√ß√£o com Formul√°rio</h3>
    <div class="code-block">
<pre><code>&lt;form onsubmit="handleFormSubmit(event)"&gt;
    &lt;input type="text" id="customerName" placeholder="Seu nome" required&gt;
    &lt;input type="email" id="customerEmail" placeholder="Seu email" required&gt;
    &lt;button type="submit"&gt;Agendar Reuni√£o&lt;/button&gt;
&lt;/form&gt;

&lt;script&gt;
async function handleFormSubmit(event) {
    event.preventDefault();
    
    const name = document.getElementById('customerName').value;
    const email = document.getElementById('customerEmail').value;
    
    // Criar reuni√£o com informa√ß√µes do cliente
    await createCallXMeeting(
        null, // v√≠deo padr√£o
        `Reuni√£o com ${name}`,
        `${window.location.origin}/obrigado?name=${encodeURIComponent(name)}&email=${encodeURIComponent(email)}`
    );
}
&lt;/script&gt;</code></pre>
    </div>

    <h2>4. Configura√ß√£o no Elementor</h2>
    <ol>
        <li>Crie um widget HTML no Elementor</li>
        <li>Cole o c√≥digo JavaScript na se√ß√£o "C√≥digo HTML"</li>
        <li>Adicione um div com ID para o bot√£o</li>
        <li>Configure o token no c√≥digo</li>
    </ol>

    <h2>5. Exemplo Completo para Elementor</h2>
    <div class="code-block">
<pre><code>&lt;div style="text-align: center; padding: 40px;"&gt;
    &lt;h2&gt;Agende sua Reuni√£o&lt;/h2&gt;
    &lt;p&gt;Clique no bot√£o abaixo para iniciar uma reuni√£o personalizada&lt;/p&gt;
    &lt;div id="callx-integration"&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;script&gt;
// Configura√ß√£o
const CALLX_CONFIG = {
    apiUrl: 'https://seu-dominio-callx.com/api/integration',
    token: 'SEU_TOKEN_AQUI'
};

// Fun√ß√£o simplificada
async function createCallXMeeting(buttonElement = null) {
    // Bloquear bot√£o imediatamente
    if (buttonElement) {
        buttonElement.disabled = true;
        buttonElement.textContent = '‚è≥ Criando reuni√£o...';
        buttonElement.style.opacity = '0.6';
        buttonElement.style.cursor = 'not-allowed';
    }

    try {
        const response = await fetch(`${CALLX_CONFIG.apiUrl}/create-meeting`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                token: CALLX_CONFIG.token,
                title: 'Reuni√£o via Site',
                redirectUrl: window.location.href
            })
        });

        const result = await response.json();
        
        if (response.ok) {
            // Sucesso - bloquear bot√£o permanentemente
            if (buttonElement) {
                buttonElement.disabled = true;
                buttonElement.textContent = '‚úÖ Reuni√£o criada!';
                buttonElement.style.background = '#28a745';
                buttonElement.style.cursor = 'not-allowed';
                buttonElement.style.opacity = '0.8';
                
                // Salvar estado no localStorage
                localStorage.setItem('callx_meeting_created', 'true');
                localStorage.setItem('callx_meeting_id', result.meetingId);
                
                console.log('‚úÖ Reuni√£o criada, localStorage salvo:', {
                    created: localStorage.getItem('callx_meeting_created'),
                    meetingId: localStorage.getItem('callx_meeting_id')
                });
            }
            
            window.open(result.meetLink, '_blank');
        } else {
            // Erro - desbloquear bot√£o
            if (buttonElement) {
                buttonElement.disabled = false;
                buttonElement.textContent = 'üöÄ Iniciar Reuni√£o';
                buttonElement.style.opacity = '1';
                buttonElement.style.cursor = 'pointer';
            }
            
            alert('Erro: ' + result.error);
        }
    } catch (error) {
        // Erro - desbloquear bot√£o
        if (buttonElement) {
            buttonElement.disabled = false;
            buttonElement.textContent = 'üöÄ Iniciar Reuni√£o';
            buttonElement.style.opacity = '1';
            buttonElement.style.cursor = 'pointer';
        }
        
        alert('Erro ao conectar com o CallX');
    }
}

// Criar bot√£o
document.addEventListener('DOMContentLoaded', () => {
    const container = document.getElementById('callx-integration');
    if (container) {
        // Verificar se j√° foi criada uma reuni√£o
        const meetingCreated = localStorage.getItem('callx_meeting_created');
        const meetingId = localStorage.getItem('callx_meeting_id');
        
        console.log('üîç Verificando localStorage:', { meetingCreated, meetingId });
        
        if (meetingCreated === 'true' && meetingId) {
            // Reuni√£o j√° foi criada - mostrar bot√£o bloqueado
            const button = document.createElement('button');
            button.textContent = '‚úÖ Reuni√£o j√° criada!';
            button.disabled = true;
            button.style.cssText = `
                background: #28a745;
                color: white;
                padding: 15px 30px;
                border: none;
                border-radius: 8px;
                font-size: 18px;
                cursor: not-allowed;
                opacity: 0.8;
            `;
            
            // Adicionar link para a reuni√£o
            const link = document.createElement('a');
            link.href = `https://google-meet-saas-v2.onrender.com/meet/${meetingId}`;
            link.target = '_blank';
            link.textContent = 'Abrir Reuni√£o';
            link.style.cssText = `
                display: block;
                margin-top: 10px;
                color: #007bff;
                text-decoration: none;
                font-weight: bold;
                text-align: center;
            `;
            
            container.appendChild(button);
            container.appendChild(link);
        } else {
            // Criar bot√£o ativo
            const button = document.createElement('button');
            button.textContent = 'üöÄ Iniciar Reuni√£o';
            button.style.cssText = `
                background: #007bff;
                color: white;
                padding: 15px 30px;
                border: none;
                border-radius: 8px;
                font-size: 18px;
                cursor: pointer;
                transition: background 0.3s;
            `;
            button.onmouseover = () => button.style.background = '#0056b3';
            button.onmouseout = () => button.style.background = '#007bff';
            button.onclick = () => createCallXMeeting(button);
            
            container.appendChild(button);
        }
    }
});
&lt;/script&gt;</code></pre>
    </div>

    <h2>6. Teste da Integra√ß√£o</h2>
    <p>Clique no bot√£o abaixo para testar a integra√ß√£o:</p>
    
    <div id="test-integration">
        <button class="button" onclick="testIntegration()">üß™ Testar Integra√ß√£o</button>
    </div>
    
    <div id="test-result"></div>

    <script>
        // Configura√ß√£o de teste
        const CALLX_CONFIG = {
            apiUrl: window.location.origin + '/api/integration',
            token: 'test-token' // Token de teste
        };

        async function testIntegration() {
            const resultDiv = document.getElementById('test-result');
            resultDiv.innerHTML = '<div class="highlight">Testando integra√ß√£o...</div>';

            try {
                const response = await fetch(`${CALLX_CONFIG.apiUrl}/create-meeting`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        token: CALLX_CONFIG.token,
                        title: 'Teste de Integra√ß√£o',
                        redirectUrl: window.location.href
                    })
                });

                const result = await response.json();
                
                if (response.ok) {
                    resultDiv.innerHTML = `
                        <div class="success">
                            ‚úÖ Integra√ß√£o funcionando!<br>
                            Meeting ID: ${result.meetingId}<br>
                            <a href="${result.meetLink}" target="_blank">Abrir Reuni√£o</a>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="error">
                            ‚ùå Erro: ${result.error}<br>
                            Status: ${response.status}
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        ‚ùå Erro de conex√£o: ${error.message}
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
